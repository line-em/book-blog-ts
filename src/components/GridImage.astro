---
import type { CollectionEntry } from "astro:content";
import { getImagePath, getUrlPath } from "../utils/digits";
import { getStars } from "../utils/rating";
import { Image } from "@astrojs/image/components";

export interface Props {
	books: CollectionEntry<"books">[];
	year?: number;
}

const { books, year } = Astro.props;
---

<section class="img-grid">
	{
		books.map((book) => {
			const imagePath = getImagePath(book.data.image, book.data.year);
			return (
				<article class="book-grid-item">
					<a href={getUrlPath(book.slug, year ? true : false)}>
						<Image
							alt={book.data.title}
							width={350}
							height={450}
							aspectRatio="4:3"
							format="webp"
							src={imagePath}
						/>
					</a>
					<a
						href={getUrlPath(book.slug, year ? true : false)}
						class="book-slug"
					>
						{book.data.title}
					</a>
					<div set:html={getStars(book.data.score)} class="book-grid-rating" />
				</article>
			);
		})
	}
</section>
